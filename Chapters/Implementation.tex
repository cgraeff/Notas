%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Implementação}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{fullwidth}\it
Detalhes sobre a implementação do modelo e resultados obtidos. Aqui os resultados se referem aos produtos dos cálculos, não a resultados interessantes em si. A ideia é mostrar que as rotinas funcionam direito e calculam o que precisamos. Tratamos o caso NJL, seguido do caso eNJL.
\end{fullwidth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Classificação dos resultados}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Para fins de organização dividimos os produtos dos cálculos em três tipos
\begin{description}
	\item[Resultados:] São os produtos cuja obtenção é a razão pela qual elaboramos os cálculos; São gerados sempre que os códigos são executados;
	\item[Testes:] Frequentemente procuramos reproduzir resultados de uma referência ou mesmo inspecionar os resultados gerados por uma rotina em particular. Ambos são considerados testes e normalmente não são gerados ao se executar o código. Para gerá-los, devemos requisitar explicitamente sua execução. Nesse caso, os produtos principais (os \emph{resultados}) não são gerados.
	\item[Testes Transientes:] Quando precisamos executar um teste para escolha de um método para o cálculo de uma determinada quantidade, sendo que não desejamos executar tal teste no futuro, podemos classificar os resultados oriundos de tal teste como transientes. Tais testes são frequentes ao se ``debugar'' o código, mas prejudicam a organização e devem ser eliminados assim que possível.
\end{description}
%
Os programas cujas implementações são descritas abaixo estão organizados levando a classificação acima em conta. Isso implica que os testes transientes mostrados abaixo não serão facilmente reprodutíveis.

%%%%%%%%%%%%%%%%%%%
\section{Dimensões}
%%%%%%%%%%%%%%%%%%%

Devido ao fato de que $\hbar = c = 1$, adimensionais, e que não carregamos quaisquer unidades, é comum que algumas equações tenham dimensões discrepantes entre os membros esquerdo e direito, ou mesmo entre termos de um mesmo membro. Podemos acertar as dimensões multiplicando por potências de $\hbar c$. Nas unidades usuais em Física Nuclear, temos que $\hbar c = \np[MeV\cdot fm]{197.326}$. Logo, todas as grandezas têm dimensões que envolvem MeV ou fm, ou uma combinação de ambos\sidenote{Note que de qualquer forma as unidades são atípicas, pois --~por exemplo~-- a unidade de massa é o eV, que na realidade tem dimensão de energia. Isso pode ser explicado através de $E^2 = p^2 c^2 + m^2 c^4$, onde assumimos que $c = 1$, adimensional.}:

\begin{itemize}
	\item Como $E^2 = p^2c^2 + m^2c^4$, temos $[E] = [m] = [p]$;
	\item Como $\rho = \bar{\psi}\gamma^0\psi$ é o número de partículas por unidade de volume, temos que $[\rho] = \rm{fm}^{-3}$
	\item O item acima implica que $[\psi] = \rm{fm}^{-3/2}$. Consequentemente, $[\rho_s] = [\bar{\psi}\psi] = \rm{fm}^{-3}$. 
	\item Como o potencial químico esta relacionado à variação de energia ao se adicionar ou retirar partículas do sistema, sua unidade é a de energia (MeV).
	\item O potencial termodinâmico $\omega$ é o potencial grande-canônico\footnote{Potencial de Landau} $\Omega$ por unidade de volume, portanto tem dimensão de energia por unidade de volume ($\rm{MeV}\cdot\rm{fm}^{-3}$), assim como a densidade de energia $\varepsilon$ e a pressão $P$.
\end{itemize}
%
Dessa forma, as equações discutidas nos capítulos anteriores precisam ter suas unidades checadas e --~quando necessário~-- corrigidas, de forma a ficarem consistentes.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fase de quarks: NJL, SU(2), temperatura zero}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Apesar de ser mais instrutivo analisar primeiramente o caso $T \neq 0$ ao estudarmos a termodinâmica do modelo NJL, a implementação do caso especial $T = 0$ é mais simples. Devido a isso, verificaremos os detalhes de implementação e resultados para esse caso antes do caso mais geral.

%%%%%%%%%%%%%%%%%%%%%%
\subsection{Algoritmo}
%%%%%%%%%%%%%%%%%%%%%%

A escolha das variáveis de \emph{loop} é uma questão de conveniência. Em especial, para o caso $T = 0$, temos ao variarmos $\rho_B$ a seguinte sequência de cálculo\footnote{Essas expressões foram calculadas quando tomamos o limite $T \to 0$.}:
\begin{align}
	\rho_B &= \textrm{escolhido arbitrariamente} \\
	p_F &= \sqrt[3]{3 \pi^2 \rho_B / n_f} \label{Eq:mom_fermi_rho_bar}\\
	\mu_R &= \sqrt{p_F^2 + m^2} \label{Eq:pot_quim_renorm_loop_dens_bar}\\
	\mu &= \mu_R + \frac{2 G_V n_f n_c}{3\pi^2(\hbar c)^2} p_F^3.
\end{align}
%
uma vez conhecidos\footnote{As expressões nas referências que estou usando costumam usar essas três variáveis.} $\mu$, $\mu_R$ e $p_F$, podemos calcular o potencial termodinâmico e --~a partir dele~-- obtemos a densidade de energia e a pressão.

Se escolhermos variar $\mu$, temos uma tarefa um pouco mais complexa, pois as variáveis $\mu_R$ e $p_F$ estão acopladas\footnote{Na realidade, esse caso não é especialmente complexo. Esse acoplamento vem das Equações~\eqref{Eqs:sist_m_mu_t_finito}. Ao rodar em $\rho_B$, para $T = 0$, ocorre uma simplificação, pois nesse caso a integral na expressão para $\rho_B$ se torna uma função degrau.}:
\begin{align}
	\mu_R &= \mu - \frac{2 G_V n_f n_c}{3\pi^2} p_F^3 \\
	p_F & = \sqrt{\mu_R^2 - m^2} \theta(\mu_R^2 - m^2). \label{Eq:mom_fermi_de_mu_m}
\end{align}
%
Temos então que
\begin{equation}
	\mu_R = \begin{cases} \mu, \quad\textrm{se}~\mu_R^2 < m^2 \\ \mu - \frac{2 G_V n_f n_c}{3\pi^2} (\mu_R^2 - m^2)^{3/2} \theta(\mu_R^2 - m^2), \quad\textrm{se}~\mu_R^2 > m^2.\end{cases}
\end{equation}
%
Podemos englobar os dois casos escrevendo a equação
\begin{equation}
	f(\mu_R) = \mu_R - \mu - \frac{2 G_V n_f n_c}{3\pi^2} (\mu_R^2 - m^2)^{3/2}) \theta(\mu_R^2 - m^2) = 0,
\end{equation}
%
que pode ser resolvida ao se achar a raíz utilizando um algoritmo para este fim. À primeira vista, pode parecer estranha a existência da função degrau em $\mu_R$, que é o que estamos tentando calcular, mas como os algoritmos ``chutam'' valores para essa variável, podemos compará-los a $m$ e determinar o valor da função. Assim que encontramos o valor de $\mu_R$ que satisfaz a expressão acima, podemos calcular $p_F$ e a densidade\footnote{Não aparece diretamente nas expressões que vi, mas é interessante como variável de saída dos cálculos.} $\rho_B$ através das expressões~\eqref{Eq:mom_fermi_de_mu_m} e~\eqref{Eq:mom_fermi_rho_bar}.

Adotaremos aqui um \emph{loop} na densidade bariônica\footnote{Em um teste para reprodução de uma figura, no entanto, utilizamos um \emph{loop} em $\mu$.}. Tal escolha se dá devido a simplicidade para o tratamento do caso $T = 0$. Como veremos adiante, entretanto, para o caso $T \neq 0$ seria mais natural executarmos o \emph{loop} em $\mu$, uma vez que estamos interessados em determinar o diagrama de fases $T \times \mu$. De qualquer forma, uma vez conhecido o valor de $\rho_B$, a determinação de $\mu$ é simples, e mesmo para temperaturas finitas, adotaremos $\rho_B$ como variável de cálculo.

Uma vez definida a variável de laço e as expressões para as demais variáveis que dependem unicamente dela, a solução do problema consiste em determinar (nesta ordem):
\begin{description}
	\item[Densidade bariônica $\rho_B$:] Esse valor é determinado arbitrariamente;
	\item[Momento de Fermi:] Como estamos tratando o caso $T = 0$, as integrais que envolvem a distribuição de Fermi-Dirac frequentemente se transformam em funções degrau envolvendo o momento de Fermi $p_F$, como por exemplo
		\begin{equation}
			\lim_{T \to 0} \int_o^\infty p^2 (n_p(T, \mu_R) - \bar{n}_p(T, \mu_R)) \;dp = \theta(p_F - p).
		\end{equation}
		Podemos determinar o valor de $p_F$ de acordo com a expressão~\eqref{Eq:mom_fermi_rho_bar}.
	\item[Potencial químico:] O potencial químico pode ser calculado de acordo com a expressão~\eqref{Eq:pot_quim_renorm_loop_dens_bar} acima.
	\item[A massa efetiva e a densidade escalar:] Precisamos solucionar a equação~\eqref{gap}. A solução deve ser encontrada utilizando-se um algoritmo para encontrar zeros de função. Veja a próxima seção para mais detalhes;
	\item[O potencial termodinâmico:] Uma vez determinados os valores de $\mu$, $\mu_R$ e $m$, podemos determinar o valor do potencial termodinâmico através da expressão~\eqref{Eq:Def_pot_termo}. Para isso, no entanto, devemos calcular
		\begin{description}
			\item[Valor mínimo do potencial termodinâmico:] Nenhuma grandeza é alterada ao se somar uma constante no potencial termodinâmico\footnote{Segundo o Buballa, eu tentei calcular $\varepsilon/\rho$ e tive problemas sem essa constante.}. Vamos nos valer desse fato para que o valor mínimo do potencial seja zero quando $T = \mu = 0$, definindo tal potencial com um ``potencial regularizado'' $\tilde\omega$:
							\begin{equation}
					\tilde\omega = \omega(\mu;m,\mu_R) - \omega(0;m_{\rm{vac}},0).
				\end{equation}
				Para isso, no entanto, devemos calcular o valor de massa $m_{\rm{vac}}$ que minimiza o potencial termodinâmico;
			\item[Determinação da massa no vácuo:] Para que possamos determinar o potencial termodinâmico $\tilde\omega$ adequadamente, precisamos determinar o valor de massa que minimiza o potencial $\omega$. Isso resulta na equação \ref{Eq:Calculo_m_vac} que --~novamente~--deve ser resolvida utilizando-se um algoritmo para determinar zeros de funções; Veja a próxima seção para mais detalhes. Uma vez determinado o valor de $m_{\rm{vac}}$, podemos determinar $\tilde\omega$.
		\end{description}	
		Como o valor de $m_{\rm{vac}}$ e o valor de $\tilde\omega$ são constantes (não dependem de $\rho_B$, direta ou indiretamente), podemos determinar tais valores antes mesmo de iniciarmos o \emph{loop} em $\rho_B$, armazenando os valores e utilizando-os quando necessário.
	\item[Pressão e a energia] Finalmente, podemos calcular a pressão e a energia através das expressões~\eqref{Eq:Pressao_omega_tilde} e~\eqref{Eq:Energia_omega_tilde};
\end{description}
%
Uma vez determinadas a massa no vácuo e a massa efetiva, a obtenção das demais grandezas é simples, uma vez conhecidas as suas expressões. Vamos discutir a determinação dos dois primeiros itens na seção a seguir. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solução auto-consistente de equações}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

As Equações~\eqref{gap}, \eqref{gap_mu_r} e~\eqref{Eq:Calculo_m_vac} são expressões para a determinação de uma variável que envolvem na expressão de cálculo a própria variável --~isto é, são equações trancendentais~--. Podemos resolver tais equações utilizando um algoritmo para determinar zeros de funções\cite{NumericalRecipes}, bastando para isso definir uma função $f$ cujos zeros devemos encontrar. No caso da Equação~\eqref{gap}, por exemplo, temos\footnote{A integral tem forma fechada, porém vamos utilizar a forma com a integral para tornar a expressão mais simples nessa discussão.}
\begin{equation}
	m = m_0 - \alpha\int_0^\Lambda \frac{m}{\sqrt{p^2 + m^2}} p^2 dp,
\end{equation}
%
onde $\alpha$ é um conjunto de constantes. Podemos definir a função $f$ como
\begin{equation}
	f(m) = m - m_0 + \alpha\int_0^\Lambda \frac{m}{\sqrt{p^2 + m^2}} p^2 dp.
\end{equation}
%
Ao determinarmos a raíz da expressão acima --~isto é, o valor de $m$ para o qual $f(m) = 0$~--, temos a solução da equação original. Numericamente esse problema pode ser resolvido de maneira bastante simples: dados dois valores $m_{min}$ e $m_{max}$ que definam um intervalo que contém uma raíz\footnote{O intervalo contém uma raíz se os sinais de $f(m_{min})$ e $f(m_{max})$ diferem.}, podemos diminuir a largura do intervalo de maneira que possamos utilizar como raíz o valor $m \approx m_{min} \approx m_{max}$. Podemos diminuir o intervalo arbitrariamente, até que $f(m)$ seja suficientemente próxima de zero. Os intervalos de $m$, $m_{rm{vac}}$ ou $\mu_R$ podem ser tomados como \np[MeV]{0,1} (proximo ao valor mínimo) e \np[MeV]{1000}, pois os valores máximos de tais grandezas é se encontra no intervalo de aproximadamente \np[MeV]{300} a \np[MeV]{450}.

Apesar de o método descrito acima ser viável, ele não é eficiente. Existem algoritmos cuja convergência é bastante mais rápida do que uma diminuição progressiva do intervalo. Além disso, em casos em que existam mais raízes, principalmente em números pares, a determinação das raízes pode ser complexa. No caso das equações que necessitamos resolver para o presente problema, no entanto, exite somente uma raíz, excluindo-se a solução trivial\footnote{É trivial verificar que zero é uma solução.}. A eficiência não é um problema, por isso utilizamos o método da biseção\footnote{Divide o intervalo em dois e verifica qual deles contém a raíz, repetindo o processo sucessivamente. Outros métodos geralmente são mais eficientes, mas podem ter problemas de convergência que não ocorrem com o método da biseção.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Análise Dimensional}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Verificando as dimensões na lagrangiana, temos
\begin{equation}
	\underbrace{\mathcal{L}}_{\mathcal{\rm{MeV}/\rm{fm}^3}} = \underbrace{\bar{\psi}}_{\rm{fm}^{3/2}}(i\gamma^\mu\underbrace{\partial_\mu}_{\rm{fm}^{-1}} - \underbrace{m_0}_{\rm{MeV}})\underbrace{\psi}_{\rm{fm}^{3/2}} + G_S [ \underbrace{(\bar{\psi}\psi)^2}_{\rm{fm}^{-6}} + \underbrace{(\bar{\psi}i\gamma_5\vec{\tau}\psi)^2}_{\rm{fm}^{-6}}].
\end{equation}
%
A constante $G_S$ tem dimensão de inverso de massa$^{-2}$ em Buballa\cite{Buballa1996}, porém adotamos que 
\begin{equation}
	[G_S] = \rm{fm}^{2}
\end{equation}
%
para que tenhamos uma dimensão igual ao caso eNJL em Pais\cite{Pais}. Assim o valor de $G_S$ da referência deve ser ajustado de acordo com
\begin{equation}
	\underbrace{G_S}_{\textrm{Buballa}} \cdot (\hbar c)^2 = \underbrace{G_S}_{\textrm{prog.}}.
\end{equation}
%
Além disso, para que dimensão da densidade lagrangiana seja adequada, temos
\begin{equation}
	\mathcal{L} = \bar{\psi}(\hbar c \cdot i\gamma^\mu\partial_\mu - m_0)\psi + \hbar c \cdot G_S[(\bar{\psi}\psi)^2 + (\bar{\psi}i\gamma_5\vec{\tau}\psi)^2].
\end{equation}
%
A relação entre a densidade bariônica e o momento de Fermi também precisa ter sua dimensão corrigida:
\begin{equation}
	\rho_B = (\hbar c)^{-3} \cdot \frac{n_f}{3\pi^2}p_F^3.
\end{equation}

Temos também que para que a expressão~\eqref{Eq:Dens_Escalar_NJL_Gv_0} para a densidade escalar tenha as dimensões corretas, devemos multiplicá-la por $(\hbar c)^{-3}$. Além disso, na Eq.~\eqref{Eq:Eq_Gap_Buballa_1} devemos multiplicar o termo proporcional a $G_S$ por $\hbar c$ de forma a obter a dimensão correta (MeV) para que possamos somar com a massa.

Para encontrar $m_{\rm{vac}}$, precisamos resolver
\begin{equation}
	m - m_0 - 2G_S\frac{n_f n_c}{\pi^2} \;m [F_0(m, \Lambda) - F_0(m,0)] = 0.
\end{equation}
%
Como $[m] = [m_0] = \rm{MeV}$, o último termo também deve estar em MeV. A dimensão de $F_0$ é $\rm{MeV}^2$, enquanto $[G_S] = \rm{fm}^2$, o que resulta -- levando em conta que o termo contém um $m$ no numerador -- em $\rm{MeV}^3\cdot\rm{fm}^2$. Para corrigir a dimensão, devemos multiplicar tal termo por $(\hbar c)^{-2}$:
\begin{equation}
	m - m_0 - 2G_S\frac{n_f n_c}{\pi^2} \;m [F_0(m, \Lambda) - F_0(m,0)] \cdot (\hbar c)^{-2} = 0.
\end{equation}

Para o cálculo do potencial termodinâmico, segundo a Equação~\ref{Eq:Pot_termodinamico_1}, temos que
\begin{align}
	[F_E] &= \left[\int_0^\Lambda p^2\sqrt{p^2+m^2} \;dp\right] = \rm{MeV}^2, \\
	[\omega] &= \rm{MeV}/\rm{fm}^3,
\end{align}
%
logo,
\begin{equation}
	\omega_{\rm{MF}} = \left\{- (\hbar c)^{-3} \cdot [F_E(m, \Lambda) - F_E(m, p_F)] - n_fn_c\mu_R\rho_B + (\hbar c) \cdot G_S\rho_S^2\right\}
\end{equation}

Para o cálculo do potencial termodinâmico através das expressões~\eqref{Eq:Pot_termodinamico_2}, temos
\begin{subequations}
\begin{align}
	\varepsilon &= \tilde{\omega} + n_c\mu\rho_B = \varepsilon_{\rm{kin}} + m_0\rho_s - (\hbar c) \cdot 2G_S\rho_s^2 - \varepsilon_0\\
	\varepsilon_0 &= \tilde{\omega}_0 + n_c\mu\rho_B = \varepsilon_{\rm{kin}}^0 + m_0\rho_0^s - (\hbar c) \cdot 2G_S(\rho_0^s)^2 \\
	\varepsilon_{\rm{kin}} &= -(\hbar c)^{-3} \cdot \frac{n_c}{\pi^2} [F_2(m, \Lambda) - F_2(m, p_F)] \\
	\varepsilon_{\rm{kin}}^0 &= -(\hbar c)^{-3} \cdot \frac{n_c}{\pi^2} [F_2(m, \Lambda) - F_2(m, 0)]
\end{align}
\end{subequations}

%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Resultados}
%%%%%%%%%%%%%%%%%%%%%%%

Consigo reproduzir\footnote{Exceto o do Set 1, que dá \np[MeV]{311.4}.} o valor da massa $m_{\rm{vac}}$ do Buballa~\cite{Buballa1996}, e os gráficos da massa efetiva e da densidade escalar se comportam de acordo com as expectativas (são parecidos com o caso de hádrons, quando $m_0 \neq 0$ a massa são vai a zero, e a densidade escalar tende a verticalizar próximo do valor da densidade máxima no caso $m_0 = 0$.).

Na Figura~\ref{Fig:pot_term_analysys_NJL-Buballa_Set_1} mostramos o potencial termodinâmico calculado para $\mu = \mu_r = p_F = \rho_B = 0$, variando $m$ arbitrariamente. O resultado é exatamente igual ao apresentado no Buballa. Também consigo reproduzir um gráfico similar que está no Report.

Ao adicionar termos em $G_V$, no entanto, não consigo reproduzir a Figura 2.8 (direita) do Report. Para poder variar o potencial termodinâmico com a massa $m$, preciso determinar o valor de $\mu_R$, sendo que $\mu$ é dado como um parâmetro. Podemos escrever a equação para $\mu_R$ como uma equação de gap:
\begin{equation}\label{Eq:Renorm_chem_pot_auto_1}
	\mu_R = \mu - \frac{2G_V n_fn_c}{3\pi^2}p_F^3,
\end{equation}
%
porém, temos que
\begin{equation}\label{Eq:Renorm_chem_pot_auto_2}
	p_F = \sqrt{\mu_R - m^2} \theta(\mu_R^2 - m^2).
\end{equation}
%
Temos que resolver as equações acima auto-consistentemente, isto é, devemos achar o zero da função
\begin{equation}
	f(\mu_R) = \mu_R - \mu + \frac{2G_V n_fn_c}{3\pi^2} \sqrt{\mu_R^2 - m^2}\theta(\mu_R^2 - m^2).
\end{equation}
%
Os resultados obtidos podem ser vistos na Fig.~\ref{Fig:Renorm_chem_pot} para $\mu \neq 0$. Para $\mu = 0$, a única solução possível é $\mu_R = 0$, já que nesse caso temos que a função é estritamente positiva (veja que o argumento da raíz é real, o que é garantido pela função degrau; devido a isso, o argumento é estritamente positivo). O gráfico do potencial obtido pode ser visto na Fig.~\ref{Fig:Fig2.8RBubR_repro}. O caso $\mu = 0$ confere com a referência, os demais são excessivamente negativos e não apresentam o mínimo local esperado. No entanto, se o termo em $G_V$ for adicionado com o sinal trocado\footnote{A Débora lembra de ter encontrado esse tipo de problema também.} (com um sinal negativo), os resultados são extremamente próximos (Fig.~\ref{Fig:Fig2.8RBubR_repro_s}).

Ao reproduzir o cálculo em Fortran obtenho bons resultados (Figuras \ref{Fig:energy_Comp_C_F} e \ref{Fig:pressure_Comp_C_F}), porém a primeira leitura que fiz das expressões não bateu com o resultado. Para que eu chegasse ao mesmo valor obtido pelo programa em Fortran, tive que tirar o 2 que multiplicava o termo $G_S \rho_S^2$. Além disso, tirei no vácuo o termo envolvendo $\mu_R$\footnote{Pensando bem, não sei por que o inseri, no potencial do vácuo nas expressões do Buballa também não há tal termo.}. O próprio potencial termodinâmico eu calculei a partir das expressões para a energia, assumindo que $\tilde{\omega} = \varepsilon - \mu_R N_c \rho_B$.
	
Apesar de reproduzir os resultados e eles serem coerentes com aquilo que eu esperava, os resultados não são bons para valores baixos de densidade\footnote{A Débora mencionou que havia um problema com o cálculo em $\rho_B$, por isso o programa em Fortran executa o cálculo variando $\mu_R$, talvez seja isso? P.S.: Se eu me referia à curva com concavidade voltada para baixo que aparece no início de alguns gráficos, como em $\varepsilon/rho$, pelo que entendi do Buballa é isso mesmo.}. De qualquer forma, os dados que seguem foram calculados segundo as expressões desse segundo caso, isto é, as expressões do programa em Fortran com as alterações mencionadas acima. 

Apesar de inicialmente eu ter feito uma interpretação errada do cálculo utilizando o potencial termodinâmico como em Buballa\cite{Buballa1996}, com a interpretação correta temos resultados adequados para a parametrização D$_1$.

%%%

\begin{figure*}
	\input{graphics/Therm_pot_analysis/graph/therm_pot_analysis.tex}
	\caption{Gráfico do potencial termodinâmico $\tilde{\omega}$ obtido variando $m$ arbitrariamente, para o valor $\mu = \mu_R = 0$. \protect\input{graphics/Therm_pot_analysis/info.tex}}
	\label{Fig:pot_term_analysys_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\centering
	\includegraphics[width=0.45\textwidth]{graphics/Therm_pot_analysis/Pot_buballa.png}
	\caption{Gráfico do potencial termodinâmico $\tilde{\omega}$ obtido variando $m$ arbitrariamente, para o valor $\mu = 0$.}
	\label{Fig:pot_term_analysys_Buballa_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/Renorm_chem_pot/renorm_chem_pot.tex}
	\caption{Gráfico de $\mu_R$ obtido autoconsistentemente a partir das Equações~\eqref{Eq:Renorm_chem_pot_auto_1} e~\eqref{Eq:Renorm_chem_pot_auto_2} para diversos valores de $\mu$ e variando-se $m$. \protect\input{graphics/Renorm_chem_pot/info.tex}}
	\label{Fig:Renorm_chem_pot}
\end{figure*}

\begin{figure*}
	\input{graphics/Fig2.8RBubR/Fig2.8RBubR.tex}
	\caption{Gráfico de $\tilde\omega$ obtido para o caso $G_V \neq 0$, variando-se $m$. \protect\input{graphics/Fig2.8RBubR/info.tex}}
	\label{Fig:Fig2.8RBubR_repro}
\end{figure*}

\begin{figure*}
	\input{graphics/Fig2.8RBubR/Fig2.8RBubR_s.tex}
	\caption{Gráfico de $\tilde\omega$ obtido para o caso $G_V \neq 0$, variando-se $m$. Nesta figura o termo em $G_V$ foi adicionado com o sinal trocado (negativo). \protect\input{graphics/Fig2.8RBubR/info.tex}}
	\label{Fig:Fig2.8RBubR_repro_s}
\end{figure*}

\begin{figure*}
	\input{graphics/Comp_C_F/graph/energy_density_per_particle.tex}
	\caption{Gráfico comparando os resultados da energia por partícula com o programa em Fortran com o em programa em C. As linhas estão sobrepostas, indicando que o cálculo funciona. \protect\input{graphics/Comp_C_F/info.tex}}
	\label{Fig:energy_Comp_C_F}
\end{figure*}

\begin{figure*}
	\input{graphics/Comp_C_F/graph/pressure.tex}
	\caption{Gráfico comparando os resultados da pressão com o programa em Fortran com o em programa em C. As linhas estão sobrepostas, indicando que o cálculo funciona. \protect\input{graphics/Comp_C_F/info.tex}}
	\label{Fig:pressure_Comp_C_F}
\end{figure*}

\FloatBarrier

%%%

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/fermi_momentum.tex}
	\caption{Gráfico do momento de Fermi $p_F$. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:fermi_momentum_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/vacuum_mass_equation.tex}
	\caption{Gráfico da equação cuja raíz determina o valor de $m_{\rm{vac}}$. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:vacuum_mass_equation_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/gap.tex}
	\caption{Gráfico da equação cuja raíz determina o valor de $m$ (``Equação do gap zerada''). \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:gap_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/vacuum_mass_equation.tex}
	\caption{Gráfico da mass $m$ em função da densidade bariônica $\rho_B$. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:mass_NJL-Buballa_Set_1}
\end{figure*}


\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/scalar_density.tex}
	\caption{Gráfico da densidade escalar. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:scalar_density_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/chemical_potential.tex}
	\caption{Gráfico do potencial químico. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:chemical_potential_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/thermodynamic_potential.tex}
	\caption{Gráfico do potencial termodinâmico $\tilde{\omega}$. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:thermodynamic_potential_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/pressure.tex}
	\caption{Gráfico da pressão. \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:pressure_NJL-Buballa_Set_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-Buballa_Set_1/graph/energy_density_per_particle.tex}
	\caption{Gráfico da razão entre a densidade de energia $\varepsilon$ e a densidade bariônica $\rho_B$ (energia por partícula). \protect\input{graphics/NJL-Buballa_Set_1/info.tex}}
	\label{Fig:energy_density_per_particle_NJL-Buballa_Set_1}
\end{figure*}

\FloatBarrier

%%%

\begin{figure*}
	\input{graphics/NJL-D_1/graph/fermi_momentum.tex}
	\caption{Gráfico do momento de Fermi $p_F$. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:fermi_momentum_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/vacuum_mass_equation.tex}
	\caption{Gráfico da equação cuja raíz determina o valor de $m_{\rm{vac}}$. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:vacuum_mass_equation_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/gap.tex}
	\caption{Gráfico da equação cuja raíz determina o valor de $m$ (``Equação do gap zerada''). \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:gap_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/vacuum_mass_equation.tex}
	\caption{Gráfico da mass $m$ em função da densidade bariônica $\rho_B$. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:mass_NJL-D_1}
\end{figure*}


\begin{figure*}
	\input{graphics/NJL-D_1/graph/scalar_density.tex}
	\caption{Gráfico da densidade escalar. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:scalar_density_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/chemical_potential.tex}
	\caption{Gráfico do potencial químico. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:chemical_potential_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/thermodynamic_potential.tex}
	\caption{Gráfico do potencial termodinâmico $\tilde{\omega}$. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:thermodynamic_potential_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/pressure.tex}
	\caption{Gráfico da pressão. \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:pressure_NJL-D_1}
\end{figure*}

\begin{figure*}
	\input{graphics/NJL-D_1/graph/energy_density_per_particle.tex}
	\caption{Gráfico da razão entre a densidade de energia $\varepsilon$ e a densidade bariônica $\rho_B$ (energia por partícula). \protect\input{graphics/NJL-D_1/info.tex}}
	\label{Fig:energy_density_per_particle_NJL-D_1}
\end{figure*}

\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fase de quarks: NJL, SU(2), temperatura finita}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%
\subsection{Algoritmo}
%%%%%%%%%%%%%%%%%%%%%%

Novamente, a escolha da variável de \emph{loop} é questão de conveniência. Como discutido no Capítulo~\ref{Chap:Termo}, as expressões~\eqref{gap}, \eqref{gap_mu_r} e~\eqref{gap_rho} devem ser resolvidas de maneira a determinar valores de $m$ e $\mu_R$ simultaneamente. Isso pode ser feito utilizando as Equações~\eqref{gap} e~\eqref{gap_mu_r} --~fornecendo como entrada os valores de $T$ e $\mu$~--, ou utilizando as Equações~\eqref{gap} e~\eqref{gap_rho} --~fornecendo os valores de $T$ e $\rho_B$~--. Como seguimos este último caso ao tomar $T = 0$, escolhemos manter a mesma convenção.

Uma vez conhecidos os valores de $\mu_R$ e $m$, a determinação de $\mu$ é simples de se obter a partir da Equação~\eqref{gap_mu_r}. Podemos observar ainda que a integral nessa expressão pode ser escrita a partir da Equação~\eqref{gap_rho} como:
\begin{equation}
	\int \frac{d^3p}{(2\pi)^3}(n_p(T, \mu_R) - \bar{n}_p(T, \mu_R)) = \frac{3}{2} \frac{\rho_B}{n_f n_c}.
\end{equation}
%
Utilizando a expressão acima em \eqref{gap_mu_r} obtemos para o potencial químico
\begin{equation}\label{Eq:pot_quim_loop_bar_dens}
	\mu = \mu_R + 2 n_c G_v \rho_B.
\end{equation}

A solução no caso $T \neq 0$ é bastante similar ao caso $T = 0$: 
\begin{description}
	\item[Temperatura:] Determinamos os valores de temperatura arbitrariamente;
	\item[Densidade bariônica $\rho_B$:] Os valores de densidade também são determinados arbitrariamente\footnote{No caso $T = 0$, definimos o momento de Fermi a partir da densidade, através da Equação~\eqref{gap_rho} no limite $T \to 0$. Como não estamos trabalhando nesse limite, não temos valores para o momento de Fermi $p_F$.}.
	\item[Massa efetiva e potencial químico:] Solucionamos as Equações~\eqref{gap} e~\eqref{gap_rho} simultaneamente, utilizando uma rotina para determinar zeros de funções de várias variáveis. Veja detalhes na próxima seção.
	\item[Potencial químico:] Uma vez determinado o potencial químico renormalizado $\mu_R$, podemor determinar o valor do potencial químico $\mu$ através da Equação~\eqref{Eq:pot_quim_loop_bar_dens}.
	\item[Potencial termodinâmico:] Com os valores de $m$, $\mu_R$ e $\mu$ --~além de $T$~-- podemos determinar o valor do potencial termodinâmico $\omega$ através da Equação~\ref{Eq:Pot_Termo_Temp_Finita}. Mais uma vez, desejamos que o valor mínimo do potencial seja nulo:
		\begin{description}
			\item[Valor mínimo do potencial termodinâmico:] Novamente, definimos um potencial termodinâmico regularizado $\tilde\omega$, sendo que seu valor para $T = \mu = 0$ é zero no ponto de mínimo:
				\begin{equation}
					\tilde\omega = \omega(T,\mu;m,\mu_R) - \omega(0,0;m_{\rm{vac}},0).
				\end{equation}
			\item[Determinação da massa no vácuo:] Como tomamos $T = 0$, o valor de $m_{\rm{vac}}$ deve ser determinado da mesma maneira que no caso anterior, através da Equação~\eqref{Eq:Calculo_m_vac}.
		\end{description}
		Como o valor de $m_{\rm{vac}}$ e o valor de $\tilde\omega$ são constantes (não dependem de $\rho_B$, direta ou indiretamente), podemos determinar tais valores antes mesmo de iniciarmos o \emph{loop} em $\rho_B$, armazenando os valores e utilizando-os quando necessário.
	\item[Entropia:] A entropia pode ser calculada a partir da derivada do potencial termodinâmico em relação à temperatura. Tal cálculo está contido na Seção~\ref{Sec:Entropia}, sendo que a expressão resultante é a Equação~\eqref{Eq:Densidade_de_entropia_deriv}.
	\item[Pressão e a energia] Finalmente, podemos calcular a pressão e a energia através das expressões~\eqref{Exp_pressao_T} e~\eqref{Exp_energia_T};
\end{description}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Raízes de equações bidimensionais}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

No caso com $T \neq 0$ --~seja utilizando um \emph{loop} na densidade bariônica $\rho_B$, seja no potencial químico $\mu$~-- precisamos determinar o zero de duas funções de duas variáveis simultaneamente. Como escolhemos o \emph{loop} na densidade bariônica, escrevemos --~a partir das Equações~\eqref{gap} e~\eqref{gap_rho}~-- as seguintes funções:
\begin{align}
	f_1(m, \mu_R) &= m - m_0 + \alpha\int_0^\Lambda \frac{m}{E} (1 - n_p(T, \mu_R) - \bar{n}_p(T, \mu_R)) p^2\;dp \\
	f_2(\rho_B, \mu_R) &= n_c\rho_B - \beta \int_0^\Lambda (n_p(T, \mu_R) - \bar{n}_p(T, \mu_R)) p^2\;dp,
\end{align}
%
onde $\alpha$ e $\beta$ são constantes. Devemos, portanto, encontrar os valores de $m$ e $\mu_R$ de forma que $f_1$ e $f_2$ sejam nulas simultaneamente.

Encontrar esses pontos não é simples, pois para cada uma das funções existe um conjunto de pontos que satisfaz a condição, sendo que a interseção entre as curvas é o zero que buscamos. Podem também existir diversas interseções para as curvas de cada equação (o sistema admite mais que uma solução), ou mesmo nenhuma interseção (o sistema não admite solução).

Numericamente, encontrar uma solução implica em determinar valores para as variáveis de forma que ambas as funções estejam tão perto de zero quanto for necessário. Isso dá origem à possibilidade de falsas raízes: as curvas dos zeros de cada função se aproximam o suficiente para que os valores das funções sejam menores do que a tolerância imposta, porém na realidade não há interseção. Devido a este tipo de problema, em geral é importante se conhecer detalhes do problema em particular, visando facilitar a solução.

Uma ferramenta interessante é justamente mapear as regiões do espaço de fase $\mu_r \times m$ em que as funções são menores que a tolerância imposta. Ao elaborarmos um gráfico de tais pontos, podemos ver claramente quais as regiões em que há interseção. Os valores das raízes assim obtidas não serão muito precisos\footnote{Mesmo com esse artifício, existe também a possibilidade de que as raízes aparentes sejam falsas, caso as regiões apenas ``se toquem''.} Para obtermos valores melhores, devemos ``polir'' as raízes utilizando algum método apropriado. Tais métodos são generalizações do método de Newton\cite{NumericalRecipes}, utilizando as derivadas parciais das funções\footnote{Esses métodos são multidimensionais, isto é, podem ser utilizados para sistemas com $n$ funções e $n$ incógnitas. Também é comum que as derivadas parciais sejam calculadas numericamente utilizando diferenças finitas.} $f_1$ e $f_2$ em relação às variáveis $m$ e $\mu_R$ para determinar a direção que se aproxima do zero. Para utilizá-los, devemos iniciar com um ``chute'' para os valores das variáveis, que serão então ``polidos'': o algoritmo utilizará as derivadas para determinar em que direção no espaço de fases devemos seguir para que o valor das raízes melhore, aceitando os valores das variáveis quando a tolerância imposta for atingida. Utilizando o mapeamento descrito acima, podemos varrer o mapa dos pontos do espaço de fases que zeram as funções a procura de regiões onde temos proximidade entre as curvas. Tais pontos podem ser utilizados como ``chutes'' iniciais.

No caso específico do presente problema, temos somente uma interseção entre as curvas, que são contínuas. Dessa forma, ao elaborarmos o mapa, podemos variar os valores de $m$ e $\mu_R$ de forma que e esta variável esteja no \emph{loop} mais interno. Isso garante que os pontos estarão ordenados em ordem crescente de $m$. Eliminamos a possível multiplicidade dos pontos fazendo a média nos valores de $\mu_R$ para cada valor de $m$. Agora basta percorrer os valores de $m$ à procura da menor distância entre os valores de $\mu_R$ de cada curva. Tal ponto será o valor estimado da posição da raíz que deverá ser passado para a rotina que deverá ``polir'' o valor até que ele esteja dentro da tolerância desejada.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Análise Dimensional}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Fazendo a análise dimensional das equações, temos
\begin{itemize}
	\item Na Equação~\eqref{Eq:Pot_Termo_Temp_Finita}, se exigimos $[\omega] = [\omega_M] = \rm{MeV}/\rm{fm}^3$, devemos multiplicar os termos $(m - m_0)^2/(4G_s)$ e $(\mu - \mu_R)^2/(4G_v)$ por $(\hbar c)^{-1}$;
	\item Na Equação~\eqref{Eq:Por_Termo_Temp_Finita_Fermi_Gas_Contrib}, se exigimos $[\omega_M] = \rm{MeV}/\rm{fm}^3$, devemos multiplicar a integral por $(\hbar c)^{-3}$;
	\item Na Equação~\eqref{Eq:Pot_quim_a_partir_de_mu_r_rho_bar}, se $[\mu] = \rm{MeV}$, o termo $2 n_c G_v \rho_B$ deve ser multiplicado por $(\hbar c)$;
	\item Na Equação~\eqref{gap}, como a massa tem dimensão de MeV, precisamos multiplicar o termo contendo a integral por $(\hbar c)^{-2}$.
	\item Na Equação~\eqref{gap_mu_r}, como o potencial químico e o potencial químico renormalizado têm dimensão MeV, devemos multiplicar o termo contendo a integral por $(\hbar c)^{-2}$.
	\item Na Equação~\eqref{gap_rho}, $[n] = \rm{fm}^{-3}$. Precisamos multiplicar lado direito por $(\hbar c)^{-3}$.
	\item Como estamos utilizando $[T] = \rm{MeV}$, a entropia é adimensional ($[k_B] = \textrm{MeV}/\rm{K}$), portanto a densidade de entropia $s$ tem dimensão de $\rm{fm}^{-3}$. Na Equação~\eqref{Eq:Densidade_de_entropia_deriv}, os termos dentro da integral são adimensionais, porém temos uma integral em $d^3p$, o que nos deixa uma dimensão de $\rm{MeV}^3$. Devemos portanto multiplicar toda a equação por $(\hbar c)^{-3}$.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Resultados $T \neq 0$}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Para o cálculo da entropia, temos três opções para o cálculo do integrando: A Equação~\eqref{Eq:Densidade_de_entropia_art}, a Equação~\eqref{Eq:Densidade_de_entropia_deriv}, e esta última simplificada, Equação~\eqref{Eq:Densidade_de_entropia_deriv_simplificada}. Quando tudo corre bem, as três formas resultam nos mesmos valores. Porém, quando estamos em situações limite temos problemas de cálculo para a primeira e a última: A primeira tem valores indefinidos (\texttt{NaN}) para algumas combinações de parâmetros, enquanto a última frequentemente tem problemas de cálculo para valores pequenos de momento.

A expressão~\eqref{Eq:Densidade_de_entropia_deriv}, no entanto, tem resultados consistentes. Acredito que os problemas numéricos têm origem na exponencial que aparece nos três casos, sendo que uma forma pode ser mais afetada que outra pois podemos ter perda de precisão ao fazer alguma operação. Com o intuito de minimizar esse tipo de problema, usei a função \texttt{log1p} sempre que possível, pois ela é capaz de calcular $\ln(1 + x)$ para $x$ pequeno sem perda de precisão. De uma maneira geral, o uso da Equação~\eqref{Eq:Densidade_de_entropia_deriv} sem a simplificação é a melhor opção. Veja as Figuras~\ref{Fig:Test_entropy_integrand_calc_0_3_0} a~\ref{Fig:Test_entropy_integrand_calc_0_4_3}.

Os gráficos obtidos para a entropia parecem razoáveis. Veja a Figura~\ref{Fig:Entropia}.

\begin{figure*}
	\input{graphics/Entropy/entropy.tex}
	\caption{Gráfico da entropia em função da massa. Linha cheia $T = \np[MeV]{10}$, linha tracejada $T = \np[MeV]{15}$. \protect\input{graphics/Entropy/info.tex}}
	\label{Fig:Entropia}
\end{figure*}

Reprodução da Fig. 2.7 (esq) do Buballa (Rep.): o resultado concorda com a referência, então isso significa que o cálculo da equação do Gap para a massa está funcionando.
\begin{figure*}
	\input{graphics/Buballa_rep_2.7/mass_at_zero_dens_as_func_temp}
	\caption{Reprodução da Figura~2.7 (Buballa). \protect\input{graphics/Buballa_rep_2.7/info.tex}}
	\label{Fig:Buballa_rep_2.7}
\end{figure*}

Nos mapas das Equações\eqref{gap} e~\eqref{gap_rho} (zeradas), para todos os valores de temperatura e densidade bariônica testados, existem duas curvas bem definidas e que se cruzam em um só ponto. O efeito do aumento da temperatura é o de deslocar as curvas para baixo, enquanto o aumento da densidade bariônica desloca a curva correspondente à Equação~\eqref{gap_rho} diagonalmente para a esquerda e para cima.

% inserir figuras aqui

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_3_0}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{300}$, $T = \np[MeV]{1.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_3_0}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_3_1}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{300}$, $T = \np[MeV]{5.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_3_1}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_3_2}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{300}$, $T = \np[MeV]{7.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_3_2}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_4_0}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{400}$, $T = \np[MeV]{1.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_4_0}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_4_1}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{400}$, $T = \np[MeV]{5.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_4_1}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_4_2}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{400}$, $T = \np[MeV]{7.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_4_2}
\end{figure*}

\begin{figure*}
	\input{graphics/Test_entropy_integrand_calc/entropy_integrand_calc_methods_0_4_3}
	\caption{Gráfico comparando os métodos de cálculo do integrando da entropia $m = \np[MeV]{50}$, $\mu_R = \np[MeV]{400}$, $T = \np[MeV]{10.0}$. \protect\input{graphics/Test_entropy_integrand_calc/info.tex}}
	\label{Fig:Test_entropy_integrand_calc_0_4_3}
\end{figure*}

\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fase de hádrons: eNJL, SU(2), temperatura zero}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%
\subsection{Algoritmo}
%%%%%%%%%%%%%%%%%%%%%%

Quase a mesma coisa que no caso anterior, mas não tem a determinação da massa no vácuo. Por outro lado, tem a história da fração de prótons que deve ser incluída. Quando ficar pronta a seção de cima, discutir essa adequadamente.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Análise dimensional}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Temos então:
\begin{fullwidth}
\begin{itemize}

\item O potencial termodinâmico (por unidade de volume) $\omega$ deve ter dimensão energia por volume (no nosso caso, $\rm{MeV}/\rm{fm}^3$):
\begin{equation}
\begin{split}
	\underbrace{\omega}_{\frac{\rm{MeV}}{\rm{fm}^3}} =&~ \underbrace{\varepsilon_{\rm{kin}}}_{\frac{\rm{MeV}}{\rm{fm}^3}} +\underbrace{m}_{\rm{MeV}}\underbrace{\rho_s}_{\rm{fm}^{-3}} - \underbrace{G_s}_{\rm{fm}^2}\underbrace{\rho_s^2}_{\rm{fm}^{-6}} + \underbrace{G_v}_{\rm{fm}^2}\underbrace{\rho^2}_{\rm{fm}^{-6}} + \underbrace{G_{sv}}_{\rm{fm}^8}\underbrace{\rho_s^2\rho^2}_{\rm{fm}^{-12}} \\
&+ \underbrace{G_\rho}_{\rm{fm}^2}\underbrace{\rho_3^2}_{\rm{fm}^{-6}} + \underbrace{G_{v\rho}}_{\rm{fm}^2}\underbrace{\rho^2\rho_3^2}_{\rm{fm}^{-12}} + \underbrace{G_{s\rho}}_{\rm{fm}^8}\underbrace{\rho_s^2\rho_3^2}_{\rm{fm}^{-12}} - \underbrace{\mu_p}_{\rm{MeV}}\underbrace{\rho_p}_{\rm{fm}^{-3}} - \underbrace{\mu_n}_{\rm{MeV}}\underbrace{\rho_n}_{\rm{fm}^{-3}}.
\end{split}
\end{equation}
%
Os termos envolvendo as constantes $G_i$ necessitam ser multiplicados por $\hbar c$, cuja dimensão é $\rm{MeV}\cdot\rm{fm}$, resultando na dimensão $\rm{MeV}/\rm{fm}^3$ para tais termos.

\item A pressão deve ter unidade de energia por unidade de volume ($\rm{MeV}/\rm{fm}^3$):
\begin{equation}
	\underbrace{P}_{\frac{\rm{MeV}}{\rm{fm}^3}} = - \underbrace{\omega}_{\frac{\rm{MeV}}{\rm{fm}^3}} + \underbrace{\varepsilon_0}_{\frac{\rm{MeV}}{\rm{fm}^3}},
\end{equation}
%
assim como a densidade de energia
\begin{equation}
	\underbrace{\varepsilon}_{\frac{\rm{MeV}}{\rm{fm}^3}} = - \underbrace{P}_{\frac{\rm{MeV}}{\rm{fm}^3}} + \underbrace{\mu_p}_{\rm{MeV}}\underbrace{\rho_p}_{\rm{fm}^{-3}} + \underbrace{\mu_n}_{\rm{MeV}}\underbrace{\rho_n}_{\rm{fm}^{-3}},
\end{equation}
%
e podemos ver que ambas estão com todas as dimensões corretas.

\item A equação para o cálculo da massa
\begin{equation}
	\underbrace{M}_{\rm{MeV}} = m - 2 \underbrace{G_s}_{\rm{fm}^2} \underbrace{\rho_s}_{\rm{fm}^{-3}} + 2 \underbrace{G_{sv}}_{\rm{fm}^8}\underbrace{\rho_s\rho^2}_{\rm{fm}^{-9}} + \underbrace{G_{s\rho}}_{\rm{fm}^8}\underbrace{\rho_s\rho_3^2}_{\rm{fm}^{-9}}
\end{equation}
%
necessita ter seus termos proporcionais a $G_i$ multiplicados por $\hbar c$.

\item A equação para a densidade bariônica
\begin{equation}
	\underbrace{\rho_i}_{\rm{fm}^{-3}} = \underbrace{\int_0^{p_F^i} \frac{p^2 dp}{\pi^2}}_{\rm{MeV}^3} = \underbrace{\frac{1}{3\pi^2}p^3\Big|_0^{p_F^i}}_{\rm{MeV}^3},
\end{equation}
%
assim como a equação para a densidade escalar
\begin{equation}
	\underbrace{\rho_s^i}_{\rm{fm}^{-3}} = \underbrace{\frac{M}{\pi^2}[F_0(M,p_F^i) - F_0(M, \Lambda)]}_{\rm{MeV}^3},
\end{equation}
%
onde usamos (vide Eq.~\eqref{Eq:Integ_momento_quad})
\begin{equation}
	F_0(m,p) = \underbrace{\int_0^x \frac{p^2}{\sqrt{p^2 + m^2}}}_{\rm{MeV}^2} dp,
\end{equation}
%
devem ser multiplicadas por $(\hbar c)^{-3}$.

\item Para o potencial químico temos
\begin{equation}
	\underbrace{\mu_i}_{\rm{MeV}} = \underbrace{E_{p_F}^i}_{\rm{MeV}} +~2 \underbrace{G_v}_{\rm{fm}^2}\underbrace{\rho}_{\rm{fm^{-3}}} +~2 \underbrace{G_{sv}}_{\rm{fm}^8}\underbrace{\rho\rho_s^2}_{\rm{fm^{-9}}} \pm~2 \underbrace{G_\rho}_{\rm{fm}^2}\underbrace{\rho_3}_{\rm{fm^{-3}}} +~2 \underbrace{G_{v\rho}}_{\rm{fm}^8}\underbrace{\rho_3^2\rho}_{\rm{fm^{-9}}} \pm~2 \underbrace{G_{v\rho}}_{\rm{fm}^8}\underbrace{\rho^2\rho_3}_{\rm{fm^{-9}}} \pm~2
\underbrace{G_{s\rho}}_{\rm{fm}^8}\underbrace{\rho_3\rho_s^2}_{\rm{fm^{-9}}},
\end{equation}
%
onde
\begin{equation}
	\underbrace{E_{p_F}^i}_{\rm{MeV}} = \sqrt{M^2 + p_F^2}; \quad [M] = [p_F] = \rm{MeV}.
\end{equation}
%
Portanto, verificamos que os termos proporcionais a $G_i$ devem ser multiplicados por $\hbar c$.

\item O termo cinético da energia é dado pela Equação~\eqref{Eq:Energia_kin}. O termo definido como $F_2(m, p)$ tem dimensão de $\rm{MeV}^4$, já que todos as parcelas são produto de $m$, $p$, e $\epsilon = \sqrt{p^2+m_i^2}$. Além disso, o argumento do logarítimo é adimensional. No entanto, como $\varepsilon_{\rm{kin}}$ é uma densidade de energia, a dimensão correta é $\rm{MeV} / \rm{fm}^3$. Portanto, é necessário multiplicar a expressão para $\varepsilon_{\rm{kin}}$ por $(\hbar c)^{-3}$.
\end{itemize}
\end{fullwidth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solução da equação para $M$, $\rho_s$}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

A solução da Equação~\eqref{Eq:Gap} é encontrada zerando a Equação~\eqref{Eq:Gap_zero}. No entanto, essa última depende de $\rho$ e dos momentos de Fermi para próton e nêutron (o que é uma dependência indireta de $\rho$ e da fração de prótons). Assim, a forma da função pode se alterar de acordo com os valores de tais variáveis. A Figura~\ref{Fig:Gap_zero_graph} mostra curvas de $f(M)$ para diferentes valores de $\rho$.

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/gap.tex}
	\caption{Exemplos de formas diferentes para $f(M)$ para valores diferentes de $\rho$. Os momentos de Fermi foram determinados a partir de \eqref{Eq:Mom_Fermi_a_partir_de_rho} com fração de prótons 1/2. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:Gap_zero_graph}
\end{figure*}

Portanto, ao se utilizar um método qualquer para se determinar o zero da função, são necessários parâmetros que tornem possível encontrar o zero da função. Como a função só tem um zero\footnote[][1cm]{Desprezando a solução trivial $M = 0$.}, temos uma situação mais simples, pois não há risco de que tenhamos que encontrar mais que um mínimo (se esse fosse o caso, teríamos que encontrar aquele que minimiza alguma energia\cite{Buballa}. Verificar.). Adotando o método da biseção, que é o mais simples, só precisamos de dois pontos que devem estar à esquerda e à direita do zero. Adotamos os valores \np{1.0e-3} e 1500 (em MeV), sendo o primeiro bastante próximo de zero e o segundo aparentemente se posiciona à direita do zero para vários valores de densidade. Não podemos adotar zero para o valor à esquerda pois $f(M=0) = 0$. A Fig.~\ref{Fig:mass_graph} mostra os valores de $M$ obtidos de acordo com o acima exposto, enquanto a Fig.~\ref{Fig:scalar_density_graph} mostra a curva das densidades escalares correspondentes, ambos para o caso $m = 0$.

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/mass.tex}
	\caption{Gráfico mostrando a massa em função da densidade bariônica para fração de prótons 1/2. Note que $M$ diminui até zero em $\rho \approx 0.35$. Nesse ponto ocorre a restauração da simetria quiral. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:mass_graph}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/scalar_density.tex}
	\caption{Gráfico da densidade escalar em função da densidade bariônica para fração de prótons 1/2. O resultado mostrado nesse gráfico é obtido juntamente com os resultados mostrados na Fig.~\ref{Fig:mass_graph} através da solução da Equação~\ref{Eq:Gap_zero}. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:scalar_density_graph}
\end{figure*}

\FloatBarrier
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Potenciais químicos, termodinâmico, pressão, e densidade de energia}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

As figuras abaixo mostram os resultados obtidos através das massas e densidades escalares obtidas na seção anterior, utilizando as Equações~\eqref{Eq:Potenciais_Quimicos}, \eqref{Eq:potencial_termodinamico}, \eqref{Eq:Pressao} e~\eqref{Eq:Densidade_energia}. Para a correta reprodução dos resultados para a pressão e para a densidade de energia, é essencial que o valor de $\varepsilon_0$ seja calculado. Podemos fazê-lo através de\footnote{Não sei de onde isso vem. Tem algum outro termo nessa equação ($\propto G_{s\rho},~G_{v\rho},~\dots$? Aparentemente não, pois não foi adicionado ao programa feito por Helena Pais.}
\begin{equation}\label{Eq:Def_dens_energia_vacuo}
	\varepsilon_0 = (\varepsilon_{\rm{kin}})_0 - G_s [(\rho_s)_0]^2
\end{equation}
%
onde\footnote{As somas são sobre prótons e nêutrons, mas como os resultados são idênticos, podemos só multiplicar por 2.}
\begin{align}
	(\varepsilon_{\rm{kin}})_0 &= \sum_i \frac{N_c}{\pi^2} (F_2(m_N,0) - F_2(m_N, \Lambda)) \label{Eq:Def_dens_energia_cin_vacuo}\\
	(\rho_s)_0 &= \sum_i \frac{m_N}{\pi^2} (F_0(m_N, 0) - F_0(m_N, \Lambda)) \label{Eq:Def_dens_escalar_vacuo}
\end{align}

Para que as dimensões fiquem corretas
\begin{itemize}
	\item O segundo termo da Equação~\eqref{Eq:Def_dens_energia_vacuo} deve ser multiplicado por $\hbar c$.
	\item O lado direito das Equações~\eqref{Eq:Def_dens_energia_cin_vacuo} e \eqref{Eq:Def_dens_escalar_vacuo} deve ser multiplicado por $(\hbar c)^{-3}$
\end{itemize}

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/chemical_potentials.tex}
	\caption{Gráfico dos potenciais químicos de próton e nêutron calculados a partir da Equação~\eqref{Eq:Potenciais_Quimicos}. Como a fração de próton é 1/2, ambos os potenciais tem o mesmo valor. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:chemical_potential_graph}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/thermodynamic_potential.tex}
	\caption{Gráfico do potencial grand canônico por unidade de volume obtido através da Equação~\eqref{Eq:potencial_termodinamico}. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:thermodynamic_potential_graph}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/pressure.tex}
	\caption{Gráfico da pressão obtido através da Equação~\eqref{Eq:Pressao}. Devido ao fato de que estamos usando $\varepsilon_o = 0$ por enquanto, a escala vertical do gráfico está deslocada no sentido positivo. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:pressure_graph}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1-Yp_0.5/graph/energy_by_nucleon.tex}
	\caption{Gráfico da razão entre a densidade de energia $\varepsilon$ e a densidade $\rho$. Note que o mínimo da energia ocorre em aproximadamente \np[fm^{-3}]{0.15}, que é a densidade de saturação da matéria nuclear. Para obtermos o valor de \np[MeV]{16} por nucleon, basta subtrairmos o valor da massa do nucleon. \protect\input{graphics/eNJL1-Yp_0.5/info.tex}}
	\label{Fig:energy_by_nucleon_graph}
\end{figure*}

\FloatBarrier
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Adição da massa constituinte à equação do Gap; adição de outros termos}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Utilizando a Equação~\ref{Eq:Gap} com $m \neq 0$, os resultados para a massa não vão a zero, apresentando o comportamento mostrado na Fig.~\ref{Fig:mass_graph_eNJL1m}.

No artigo Pais, Menezes, Providência, não há nenhuma alteração na energia cinética (Eq.~(5)), o que está diferente do Artigo\cite{PRC_68_035804_2003} (deveria haver o segundo termo da Eq.~\eqref{Eq:Engergia_cin_separada}). No entanto, segundo a Débora isso se deve ao fato de que a energia é definida de maneira diferente. No cálculo da energia cinética no vácuo, devemos adicionar um termo $m (\rho_s)_0$, obtendo:
\begin{equation}
	\varepsilon_0 = (\varepsilon_{\rm{kin}})_0 + m (\rho_s)_0 - G_s [(\rho_s)_0]^2.
\end{equation}
%
O termo adicionado a essa equação corresponde \emph{exatamente} ao segundo termo da Eq.~\eqref{Eq:Engergia_cin_separada}, o que pode ser visto utilizando a definição de $\rho_s$ e $F_0$ dadas pelas Equações~\eqref{Eq:Dens_Escalar} e~\eqref{Eq:Def_F0}\footnote{Por que isso aparece só no cálculo de $\varepsilon_0$?}. Com essas correções, os resultados estão de acordo com os contidos em Pais\cite{Pais}.

\vspace{1cm}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/gap.tex}
	\caption{Exemplos de formas diferentes para $f(M)$ para valores diferentes de $\rho$. Os momentos de Fermi foram determinados a partir de \eqref{Eq:Mom_Fermi_a_partir_de_rho} com fração de prótons 1/2. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:Gap_zero_graph_eNJL1m}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/mass.tex}
	\caption{Gráfico mostrando a massa em função da densidade bariônica para fração de prótons 1/2. Note que $M$ diminui até zero em $\rho \approx 0.35$. Nesse ponto ocorre a restauração da simetria quiral. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:mass_graph_eNJL1m}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/scalar_density.tex}
	\caption{Gráfico da densidade escalar em função da densidade bariônica para fração de prótons 1/2. O resultado mostrado nesse gráfico é obtido juntamente com os resultados mostrados na Fig.~\ref{Fig:mass_graph} através da solução da Equação~\ref{Eq:Gap_zero}. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:scalar_density_graph_eNJL1m}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/chemical_potentials.tex}
	\caption{Gráfico dos potenciais químicos de próton e nêutron calculados a partir da Equação~\eqref{Eq:Potenciais_Quimicos}. Como a fração de próton é 1/2, ambos os potenciais tem o mesmo valor. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:chemical_potential_graph_eNJL1m}
\end{figure*}

\FloatBarrier

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/thermodynamic_potential.tex}
	\caption{Gráfico do potencial grand canônico por unidade de volume obtido através da Equação~\eqref{Eq:potencial_termodinamico}. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:thermodynamic_potential_graph_eNJL1m}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/pressure.tex}
	\caption{Gráfico da pressão obtido através da Equação~\eqref{Eq:Pressao}. Devido ao fato de que estamos usando $\varepsilon_o = 0$ por enquanto, a escala vertical do gráfico está deslocada no sentido positivo. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:pressure_graph_eNJL1m}
\end{figure*}

\begin{figure*}
	\input{graphics/eNJL1m-Yp_0.5/graph/energy_by_nucleon.tex}
	\caption{Gráfico da razão entre a densidade de energia $\varepsilon$ e a densidade $\rho$. Note que o mínimo da energia ocorre em aproximadamente \np[fm^{-3}]{0.15}, que é a densidade de saturação da matéria nuclear. Para obtermos o valor de \np[MeV]{16} por nucleon, basta subtrairmos o valor da massa do nucleon. \protect\input{graphics/eNJL1m-Yp_0.5/info.tex}}
	\label{Fig:energy_by_nucleon_graph_eNJL1m}
\end{figure*}

\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%
\section{Próximas ações}
%%%%%%%%%%%%%%%%%%%%%%%%

NJL:
\begin{itemize}
	\item Adição de temperatura:
		\begin{itemize}
			\item Como integrar a solução para $T \neq 0$ à solução para $T = 0$ no programa?
			\item Escrever função para calcular $\rho_s$ no caso $T \neq 0$;
			\item Escrever função para gerar os mapas;
			\item Escrever função para estimar raízes usando os mapas;
		\end{itemize}
	\item Atualizar README.md
	\item Implementar testes para reproduzir as figuras 2.9, 2.10 e 2.12 do Buballa Report
	\item Colocar as tabelas de parâmetros para NJL e eNJL neste capítulo; A do NJL tem que pegar dos artigos, do eNJL está em algum dos capítulos.
	\item Renomear as funções \texttt{Zeroed*} para \texttt{PolynomialFunctionOf*}, já que esse é o nome certo das equações dessa forma, no contexto de \emph{root finding}. \footnote{Every polynomial $P$ in $x$ corresponds to a function, $f(x) = P$ (where the occurrences of $x$ in $P$ are interpreted as the argument of $f$), called the polynomial function of $P$; the equation in $x$ setting $f(x) = 0$ is the polynomial equation corresponding to $P$.} \textbf{Nadaver:} Isso é pra polinômio. Chamar de \texttt{CanonicalGapEquationFor*} talvez.
	\item As funções \texttt{WriteZeroedGapEquation}, \texttt{WriteVacuumMassEquation} e \texttt{WriteZeroedRenormalizedChemicalPotentialEquation} são só pra teste. Extinguí-las e adicionar o conteúdo diretamente à seção de testes. Reorganizar os testes do início, colocar algum propósito específico neles. Ou fazer um seção de testes genéricos. Reorganizar os gnuplot.gpi. Evitar testes que tem que escrever centenas de arquivos, focar em algo mais específico.
	\item criar função para abrir arquivos, criar o caminho quando necessário e checkar se o arquivo foi aberto. Dar mensagens de erro adequadas.
	\item Fix-me: Remover primeira parte do \texttt{if} no potencial químico pois ela não faz nada; Substituir por != 0 (em Reproduce Fig. 2.8 (right) from  M. Buballa, Physics Reports 407 (2005) 205-376)
	\item ver se tem como declarar os parâmetros em "sub-structs", assim fica mais fácil reusar algum grupo se necessário, além de que fica mais interessante algo como \texttt{parameters.model.cutoff}, \texttt{parameters.distribution-integrals.foo}, ...
	\item Fix treatment of temperature, it should be a variable, not a parameter.
	\item Fix all \texttt{FIXME}s
	\item Fazer um esquema de log que imprima na tela e salve em um arquivo (opcionalmente) (com opção para não imprimir na tela -q e para salvar o arquivo -l)?
	\item Mover parâmetros específicos para o cálculo da entropia para \texttt{struct parameters}.
	\item Reorganizar testes e resultados:
		\begin{itemize}
			\item Separar o que é teste de reprodução, do que é teste de debug, do que é resultado; (Resultado é tudo aquilo que tenha que ser calculado no loop principal que ocorre na densidade, ao se calcular o potencial termodinâmico, ou que dependa diretamente de valores que são calculados nesse loop. Também qq coisa que dependa da temperatura, se passarmos a fazer um loop principal na temperatura (melhor fazer um loop separado, onde calcularemos os resultados selecionados que desejamos, se for um loop dentro do outro, vai gerar uma quantidade enorme de dados; No entanto, talvez seja necessário para podermos gerar o diagrama de fases).
			\item Adicionar mapas aos resultados; Mostrar efeito da variação da temperatura e da variação da densidade.
			\item Reorganizar diretórios, scripts para fazer gráficos. Temos que levar em conta que existem duas possibilidades agora: $T = 0$ e $T \neq 0$. Além disso, temos os testes e os resultados regulares. Idealmente, todos os gráficos contidos nesse pdf deveriam ser gerados lá, mesmo que tivessem que ser várias execuções (uma para cada parametrização). Gerar tanto os gráficos em png, quanto em tex, aí fica fácil de copiar ... e não precisaria dos scripts e dados nas notas (apesar de que seria bom manter, só pra poder gerar o pdf no futuro; às vezes uma incompatibilidade entre um gráfico .tex gerado e uma versão nova do pdflatex podem impossibilitar o uso do gráfico pronto, sendo necessário gerar de novo).
		\end{itemize}
	\item fazer função para calcular $\mu$ a partir de $\mu_R$
	\item Reprodução da Fig. 2.7 (esq) do Buballa (Rep.) fica um pouco ``jagged'', cheia de degraus; Verificar.
	\item Review da discussão de resultados.
	\item Entropia:
		\begin{itemize}
			\item Ao calcular as equações de estado, escrever a entropia também. Como podemos ter problemas numéricos ao calcular o integrando da entropia, uma inspeção visual no resultado para a entropia é importante para sabermos que não estamos calculando nada estranho.
			\item Mover parâmetros de controle da integral da entropia para a \texttt{struct Parameters}.
		\end{itemize}
\end{itemize}

eNJL:
\begin{itemize}
	\item Adição da temperatura;
\end{itemize}

Diagrama de fases:
\begin{itemize}
	\item Criar novo projeto para efetuar o cálculo do diagrama de fases;
\end{itemize}
